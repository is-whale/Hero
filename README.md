# RoboMaster HLL战队2021步兵程序

---

## 硬件

0. Robomaster开发板（A型）
1. 底盘4个3508电机连接C620电调连接CAN1
2. 云台2个GM6020电机和发射机构波轮6002电机连接C610电调连接连接CAN2
3. 弹舱盖舵机和摩擦轮两个电机连接C615电调连接定时器2的通道1、3、4
4. 串口3用作调试输出
5. 串口1经过电平反向器连接至RM遥控器接收机
6. 串口6连接NUC获取自瞄数据
7. 串口8连接裁判系统
8. 串口7连接WT61C陀螺仪（未使用板载陀螺仪）

---

## 开发环境

* Keil MDK5
* STM32 CubeMx

---

## 功能介绍

* ### 板载LED（1红+1绿+8LED阵列）
    * 绿灯每秒闪烁2次，可通过闪烁状态判断系统是否正常运行

    * LED整列（8颗LED）用于模块状态指示。LED亮代表模块在线，否则代表模块离线。LED对应的模块如下。
        1. 遥控器接收机
        2. 底盘4个电机
        3. 云台2个电机
        4. 发射机构波轮电机
        5. 自瞄NUC
        6. 裁判系统
        7. 超级电容
        8. 陀螺仪

* ### 串口指令（Shell）
    * 串口3支持串口指令，输入?可查看所有指令
    * 串口指令不需要回车（"\r\n"）结尾
    * 可通过相应指令进行PID的参数调整
    * ` //参考自 https://gitee.com/somebug/atomlib/tree/master `

* ### 遥控器操作逻辑
    * 左摇杆y轴控制前进后退
    * 左摇杆x轴控制左右平移
    * 右摇杆y轴控制云台俯仰
    * 右摇杆x轴控制云台左右
    * 左上角开关从中间位置往上波切换操作设备（遥控器，键鼠）
    * 左上角开关从中间位置往下波切换机器人模式
    * 右上角开关从中间位置往上波切换发射模式（单发、三连发、连发）
    * 右上角开关从中间位置往下波控制摩擦轮和弹仓盖
    * 左上角波动摇杆是发射按钮

* ### 键鼠操作逻辑
    1. WASD前后左右
    2. 鼠标滑动控制云台移动
    3. 鼠标左键 连发
    4. 鼠标右键 三连发
    5. Shift 按住加速
    6. Ctrl切换底盘运动模式(跟S、小陀螺)
    7. R开关弹舱
    8. E开关摩擦轮
    9. G开关自瞄
    10. Z特殊模式

---

## 文件夹介绍
1. CMISS arm、stm32库
2. CMISS\DSP arm数学库
3. FWLIB stm32固件库
4. FreeRTOS FreeRTOS库
5. USER 主函数、基础用户函数
6. DEVICE 驱动相关
7. HARDWARE 硬件相关
8. USERLIB 用户库
9. SHELL 串口指令
10. TASK RTOS所有任务

## 待改进（加入）功能
1. 客户端增加gui显示
2. 模糊PID
3. 显示屏（不急）
4. 陀螺仪（不急）